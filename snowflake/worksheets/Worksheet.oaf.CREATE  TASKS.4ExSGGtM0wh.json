{
  "FolderID": "",
  "FolderName": "",
  "OwnerUserID": "197064206853",
  "OwnerUserName": "BASILOGBONNA",
  "Version": 1178,
  "URL": "/west-europe.azure/oaf/w4ExSGGtM0wh#query",
  "WorksheetID": "4ExSGGtM0wh",
  "WorksheetName": "CREATE  TASKS",
  "LocalPath": "/Users/mrcea/Desktop/oaf/data-tools/snowflake/worksheets/Worksheet.oaf.CREATE  TASKS.4ExSGGtM0wh.json",
  "StartedUtc": "2023-03-14T10:01:02.9827805Z",
  "EndedUtc": "0001-01-01T00:00:00",
  "ModifiedUtc": "2023-03-14T10:01:08.491195Z",
  "Role": "DATAENGINEER",
  "Warehouse": "DEV_WH",
  "Database": "DEVELOPMENT",
  "Schema": "PUBLIC",
  "Query": "CREATE OR REPLACE TASK DEVELOPMENT.SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES\nWAREHOUSE='DEV_WH'\nSCHEDULE = 'USING CRON 59 * * * * Africa/Maputo'\nUSER_TASK_TIMEOUT_MS = 1200000\nSUSPEND_TASK_AFTER_NUM_FAILURES = 3\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAS \nCALL DEVELOPMENT.SALES.SP_INCREMENTLOAD_ODOO_SALES();\n\nCREATE OR REPLACE TASK DEVELOPMENT.SALES.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_SALES\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO TEST FALSE POSITIVE IN QUALITY CHECKS'\nAFTER DEVELOPMENT.SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.SALES.ODOO_SALES_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_TEST_INCREMENTLOAD(\n'DEVELOPMENT.SALES.ODOO_SALES',\n'PRODUCTION.SALES.ODOO_SALES',\n'ID',\n'POS_ORDER_LINE_ID',\n'PRODUCTION.SALES.SP_INCREMENTLOAD_ODOO_SALES_TEST',\n'RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_SALES'\n);\n\nCREATE OR REPLACE TASK DEVELOPMENT.SALES.RUN_SP_CHECK_INCREMENTLOAD_ODOO_SALES\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK'\nAFTER DEVELOPMENT.SALES.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_SALES\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.SALES.ODOO_SALES_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_INCREMENTLOAD(\n'DEVELOPMENT.SALES.ODOO_SALES',\n'PRODUCTION.SALES.ODOO_SALES',\n'ID',\n'POS_ORDER_LINE_ID',\n'PRODUCTION.SALES.SP_INCREMENTLOAD_ODOO_SALES',\n FALSE\n);\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS\nWAREHOUSE='DEV_WH'\nSCHEDULE = 'USING CRON 59 * * * * Africa/Maputo'\nUSER_TASK_TIMEOUT_MS = 1200000\nSUSPEND_TASK_AFTER_NUM_FAILURES = 3\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAS CALL DEVELOPMENT.CLIENT.SP_INCREMENTLOAD_ODOO_CUSTOMERS();\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_CUSTOMERS\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.CLIENT.ODOO_CUSTOMERS_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_TEST_INCREMENTLOAD(\n'DEVELOPMENT.CLIENT.ODOO_CUSTOMERS',\n'PRODUCTION.CLIENT.ODOO_CUSTOMERS',\n'ID',\n'USER_ID',\n'PRODUCTION.CLIENT.SP_INCREMENTLOAD_ODOO_CUSTOMERS_TEST',\n'RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_CUSTOMERS'\n);\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_CHECK_INCREMENTLOAD_ODOO_CUSTOMERS\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_CUSTOMERS\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.CLIENT.ODOO_CUSTOMERS_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_INCREMENTLOAD(\n'DEVELOPMENT.CLIENT.ODOO_CUSTOMERS',\n'PRODUCTION.CLIENT.ODOO_CUSTOMERS',\n'ID',\n'USER_ID',\n'PRODUCTION.CLIENT.SP_INCREMENTLOAD_ODOO_CUSTOMERS',\nFALSE\n);\n\n\nCREATE OR REPLACE TASK DEVELOPMENT.LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY\nWAREHOUSE='DEV_WH'\nSCHEDULE = 'USING CRON 59 * * * * Africa/Maputo'\nUSER_TASK_TIMEOUT_MS = 1200000\nSUSPEND_TASK_AFTER_NUM_FAILURES = 3\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAS CALL DEVELOPMENT.LOGISTICS.SP_INCREMENTLOAD_ODOO_INVENTORY();\n\nCREATE OR REPLACE TASK DEVELOPMENT.LOGISTICS.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_INVENTORY\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.LOGISTICS.ODOO_INVENTORY_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_TEST_INCREMENTLOAD(\n'DEVELOPMENT.LOGISTICS.ODOO_INVENTORY',\n'PRODUCTION.LOGISTICS.ODOO_INVENTORY',\n'ID',\n'STOCK_QUANT_ID',\n'PRODUCTION.LOGISTICS.SP_INCREMENTLOAD_ODOO_INVENTORY_TEST',\n'RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_INVENTORY'\n);\n\nCREATE OR REPLACE TASK DEVELOPMENT.LOGISTICS.RUN_SP_CHECK_INCREMENTLOAD_ODOO_INVENTORY\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 1200000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.LOGISTICS.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_INVENTORY\nWHEN SYSTEM$STREAM_HAS_DATA('DEVELOPMENT.LOGISTICS.ODOO_INVENTORY_STREAM')\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_INCREMENTLOAD(\n'DEVELOPMENT.LOGISTICS.ODOO_INVENTORY',\n'PRODUCTION.LOGISTICS.ODOO_INVENTORY',\n'ID',\n'STOCK_QUANT_ID',\n'PRODUCTION.LOGISTICS.SP_INCREMENTLOAD_ODOO_INVENTORY',\nFALSE\n);\n\nALTER TASK IF EXISTS SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES SET SCHEDULE = 'USING CRON 59 * * * * Africa/Maputo';\nALTER TASK IF EXISTS CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS SET SCHEDULE = 'USING CRON 59 * * * * Africa/Maputo' ;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY SET SCHEDULE = 'USING CRON 59 * * * * Africa/Maputo';\n\nALTER TASK IF EXISTS SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES SET TIMEZONE = 'Africa/Maputo';\nALTER TASK IF EXISTS CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS SET TIMEZONE = 'Africa/Maputo';\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY SET TIMEZONE = 'Africa/Maputo';\n\nALTER TASK IF EXISTS SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES SUSPEND;\nALTER TASK IF EXISTS SALES.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_SALES SUSPEND;\nALTER TASK IF EXISTS SALES.RUN_SP_CHECK_INCREMENTLOAD_ODOO_SALES SUSPEND;\nALTER TASK IF EXISTS CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS SUSPEND;\nALTER TASK IF EXISTS CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_CUSTOMERS SUSPEND;\nALTER TASK IF EXISTS CLIENT.RUN_SP_CHECK_INCREMENTLOAD_ODOO_CUSTOMERS SUSPEND;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY SUSPEND;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_INVENTORY SUSPEND;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_CHECK_INCREMENTLOAD_ODOO_INVENTORY SUSPEND;\n\nALTER TASK IF EXISTS SALES.RUN_SP_CHECK_INCREMENTLOAD_ODOO_SALES RESUME;\nALTER TASK IF EXISTS SALES.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_SALES RESUME;\nALTER TASK IF EXISTS SALES.RUN_SP_INCREMENTLOAD_ODOO_SALES RESUME;\nALTER TASK IF EXISTS CLIENT.RUN_SP_CHECK_INCREMENTLOAD_ODOO_CUSTOMERS RESUME;\nALTER TASK IF EXISTS CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_CUSTOMERS RESUME;\nALTER TASK IF EXISTS CLIENT.RUN_SP_INCREMENTLOAD_ODOO_CUSTOMERS RESUME;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_CHECK_INCREMENTLOAD_ODOO_INVENTORY RESUME;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_CHECK_TEST_INCREMENTLOAD_ODOO_INVENTORY RESUME;\nALTER TASK IF EXISTS LOGISTICS.RUN_SP_INCREMENTLOAD_ODOO_INVENTORY RESUME;\n\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_KOBO_STAGING_SEASONAL_CLIENTS_ENROLLMENTS\nWAREHOUSE='DEV_WH'\nSCHEDULE = '1 minute'\nUSER_TASK_TIMEOUT_MS = 120000\nSUSPEND_TASK_AFTER_NUM_FAILURES = 3\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAS CALL STAGING.KOBO.SP_INCREMENTLOAD_FARMERS_ENROLLMENT_KENLR23();\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_KOBO_SEASONAL_CLIENTS_ENROLLMENTS\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 120000\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.CLIENT.RUN_SP_KOBO_STAGING_SEASONAL_CLIENTS_ENROLLMENTS\nWHEN SYSTEM$STREAM_HAS_DATA('STAGING.KOBO.KENYA_FARMERS_ENROLLMENT_LR23_STREAM')\nAS CALL DEVELOPMENT.CLIENT.SP_INCREMENTLOAD_KOBO_KENYA_FARMER_ENROLLMENT_LR23();\n\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 120000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.CLIENT.RUN_SP_KOBO_SEASONAL_CLIENTS_ENROLLMENTS\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_TEST_INCREMENTLOAD(\n'DEVELOPMENT.CLIENT.KOBO_SEASONAL_CLIENTS_ENROLLMENTS',\n'PRODUCTION.CLIENT.KOBO_SEASONAL_CLIENTS_ENROLLMENTS',\n'ID',\n'KOBO_ID',\n'PRODUCTION.CLIENT.SP_INCREMENTLOAD_KOBO_KENYA_FARMER_ENROLLMENT_LR23_TEST',\n'RUN_SP_CHECK_TEST_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS'\n);\n\nCREATE OR REPLACE TASK DEVELOPMENT.CLIENT.RUN_SP_CHECK_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS\nWAREHOUSE='DEV_WH'\nUSER_TASK_TIMEOUT_MS = 120000\nCOMMENT = 'THIS TASK IS MEANT TO RUN QUALITY CHECKS AND THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAFTER DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS\nAS CALL PRODUCTION.PUBLIC.SP_CHECK_INCREMENTLOAD(\n'DEVELOPMENT.CLIENT.KOBO_SEASONAL_CLIENTS_ENROLLMENTS',\n'PRODUCTION.CLIENT.KOBO_SEASONAL_CLIENTS_ENROLLMENTS',\n'ID',\n'KOBO_ID',\n'PRODUCTION.CLIENT.SP_INCREMENTLOAD_KOBO_KENYA_FARMER_ENROLLMENT_LR23',\nFALSE\n);\n\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_KOBO_STAGING_SEASONAL_CLIENTS_ENROLLMENTS SET TIMEZONE = 'Africa/Maputo';\n\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_KOBO_STAGING_SEASONAL_CLIENTS_ENROLLMENTS SUSPEND;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_KOBO_SEASONAL_CLIENTS_ENROLLMENTS SUSPEND;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS SUSPEND;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_CHECK_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS SUSPEND;\n\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_CHECK_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS RESUME;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_CHECK_TEST_INCREMENTLOAD_KOBO_SEASONAL_CLIENTS_ENROLLMENTS RESUME;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_KOBO_SEASONAL_CLIENTS_ENROLLMENTS RESUME;\nALTER TASK IF EXISTS DEVELOPMENT.CLIENT.RUN_SP_KOBO_STAGING_SEASONAL_CLIENTS_ENROLLMENTS RESUME;\n\nCREATE OR REPLACE TASK LANDING.KOBO.RUN_SP_TRUNCATELOAD_KOBO_ENROLLMENTS\nWAREHOUSE='DEV_WH'\nSCHEDULE = 'USING CRON  0 * * * * Africa/Maputo'\nUSER_TASK_TIMEOUT_MS = 1200000\nSUSPEND_TASK_AFTER_NUM_FAILURES = 3\nCOMMENT = 'THIS TASK IS MEANT TO RUN THE STORED PROCEDURE DAILY WITH A MAXIMUM TIME TO RUN OF 20 MINS FOR ANY TASK AND A MAXIMUM OF 3 FAILURES'\nAS \nCALL LANDING.KOBO.CLEANUP_LANDING();\n\nALTER TASK IF EXISTS LANDING.KOBO.RUN_SP_TRUNCATELOAD_KOBO_ENROLLMENTS RESUME;\n\n-- Since the commcare 2022 pipeline is stagnant no need to create a task for it just call the sotred procedure below\n\nCALL SP_TRUNCATELOAD_LOAD_COMMCARE_2022();\nCALL PRODUCTION.PUBLIC.SP_TRUNCATELOAD_LOAD_COMMCARE_2022();\n\n\n\n",
  "Parameters": [],
  "Charts": [],
  "FileSystemSafeName": "Worksheet.oaf.CREATE  TASKS.4ExSGGtM0wh.json",
  "_CreatedWith": "Snowflake Snowsight Extensions",
  "_CreatedVersion": "2023.2.8.0",
  "AccountName": "oaf",
  "AccountFullName": "oaf.west-europe.azure",
  "AccountUrl": "https://oaf.west-europe.azure.snowflakecomputing.com",
  "OrganizationID": "320344210810",
  "Region": "west-europe.azure"
}