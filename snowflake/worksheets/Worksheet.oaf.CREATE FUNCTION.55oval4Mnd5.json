{
  "FolderID": "",
  "FolderName": "",
  "OwnerUserID": "197064206853",
  "OwnerUserName": "BASILOGBONNA",
  "Version": 109,
  "URL": "/west-europe.azure/oaf/w55oval4Mnd5#query",
  "WorksheetID": "55oval4Mnd5",
  "WorksheetName": "CREATE FUNCTION",
  "LocalPath": "/Users/mrcea/Desktop/oaf/data-tools/snowflake/worksheets/Worksheet.oaf.CREATE FUNCTION.55oval4Mnd5.json",
  "StartedUtc": "2023-03-02T13:07:09.0943175Z",
  "EndedUtc": "0001-01-01T00:00:00",
  "ModifiedUtc": "2023-03-02T14:01:30.122091Z",
  "Role": "DATAENGINEER",
  "Warehouse": "DEV_WH",
  "Database": "STAGING",
  "Schema": "",
  "Query": "CREATE OR REPLACE FUNCTION ODOO.GET_NAME(EMAIL VARCHAR)\nRETURNS VARCHAR NOT NULL\nCOMMENT = 'SPLITS NAME FROM ONE ACRE FUND EMAIL AND GETS THE USER NAME'\nAS 'REPLACE(SPLIT_PART(EMAIL,''@'',0),''.'','' '')';\n\n\nCREATE OR REPLACE FUNCTION KOBO.STANDARD_GEO_DATA(STRING_VAL VARCHAR)\nRETURNS VARCHAR \nAS '';\n\nCREATE OR REPLACE FUNCTION KOBO.STANDARD_GEO_DATA(RETURNED VARCHAR, STRING_VAL VARCHAR)\n  RETURNS FLOAT\n  AS '\n  WITH CTE(value) as (\n   SELECT SPLIT_PART(STRING_VAL,'';'',0) as value\n  )\n  select COALESCE(RETURNED+'' '', '''') + SUBSTRING(trim(value), CHARINDEX('' '', trim(value)), CHARINDEX('' '', trim(value), CHARINDEX('' '', trim(value))+1)- CHARINDEX('' '', trim(value))) + '' '' + left(trim(value),charindex('' '', trim(value)))+'','' INTO RETURNED from cte';\n\n-- \n-- with cte(value) as \n\n-- + SUBSTRING(trim(value), CHARINDEX('' '', trim(value)), CHARINDEX('' '', trim(value), CHARINDEX('' '', trim(value))+1)- CHARINDEX('' '', trim(value))) + '' '' + left(trim(value),charindex('' '', trim(value)))+'',''\n-- SET LONGSTRING = (select COALESCE(:LONGSTRING+' ', '') + SUBSTRING(trim(value), CHARINDEX(' ', trim(value)), CHARINDEX(' ', trim(value), CHARINDEX(' ', trim(value))+1)- CHARINDEX(' ', trim(value))) + ' ' + left(trim(value),charindex(' ', trim(value)))+',' from cte);\n\n\n",
  "Parameters": [],
  "Charts": [],
  "FileSystemSafeName": "Worksheet.oaf.CREATE FUNCTION.55oval4Mnd5.json",
  "_CreatedWith": "Snowflake Snowsight Extensions",
  "_CreatedVersion": "2023.2.8.0",
  "AccountName": "oaf",
  "AccountFullName": "oaf.west-europe.azure",
  "AccountUrl": "https://oaf.west-europe.azure.snowflakecomputing.com",
  "OrganizationID": "320344210810",
  "Region": "west-europe.azure"
}